# Surge Rule Set for Meta AI
# NAME: Meta AI
# AUTHOR: linchao10058
# REPO: https://raw.githubusercontent.com/linchao10058/Surge/main/Rule/meta_ai.list
# UPDATED: 2025-06-06 12:18 PDT
# TOTAL: 20 rules
# DESCRIPTION: Surge rules for routing Meta AI traffic (meta.ai, ai.meta.com, and related AI research domains) through a proxy. Excludes non-AI Meta services (e.g., Facebook, Instagram, WhatsApp). Supports dynamic updates via GitHub/GitLab. Compatible with Surge 5 and above.

[Rule]

# 1. Meta AI Core Domains
DOMAIN-SUFFIX,meta.ai,PROXY
DOMAIN-SUFFIX,ai.meta.com,PROXY
DOMAIN,imagine.meta.com,PROXY
DOMAIN-KEYWORD,meta-ai,PROXY
DOMAIN-SUFFIX,botorch.org,PROXY
DOMAIN-SUFFIX,buck.build,PROXY
DOMAIN-SUFFIX,fasttext.cc,PROXY
DOMAIN-SUFFIX,fbinfer.com,PROXY
DOMAIN-SUFFIX,flow.dev,PROXY
DOMAIN-SUFFIX,pyrobot.org,PROXY
DOMAIN-SUFFIX,rocksdb.org,PROXY
# Add CDN domains after verification
# Example: DOMAIN-SUFFIX,akamaihd.net,PROXY

# 2. Other Meta Services (Non-AI, routed to DIRECT)
DOMAIN-SUFFIX,careersatfb.com,DIRECT
DOMAIN-SUFFIX,crowdtangle.com,DIRECT
DOMAIN-SUFFIX,facebook.net,DIRECT
DOMAIN-SUFFIX,facebookbrand.com,DIRECT
DOMAIN-SUFFIX,fbcdn-a.akamaihd.net,DIRECT
DOMAIN-SUFFIX,fna.fbcdn.net,DIRECT
DOMAIN-SUFFIX,igcdn.com,DIRECT
DOMAIN-SUFFIX,igtv.com,DIRECT
DOMAIN-SUFFIX,instagram-brand.com,DIRECT
DOMAIN-SUFFIX,messenger.com,DIRECT
DOMAIN-SUFFIX,oculuscdn.com,DIRECT
DOMAIN-SUFFIX,reactjs.org,DIRECT
DOMAIN-SUFFIX,whatsapp.com,DIRECT
DOMAIN-SUFFIX,yogalayout.com,DIRECT
RULE-SET,https://raw.githubusercontent.com/linchao10058/Surge/main/Rule/meta_non_ai_dynamic.list,DIRECT

# 3. Meta AI IP Ranges
IP-CIDR,157.240.241.0/24,PROXY
IP-CIDR,31.13.85.0/24,PROXY
IP-CIDR,185.89.216.0/22,PROXY
# Add CDN IP ranges after verification
# Example: IP-CIDR,104.64.0.0/10,PROXY

# 4. Other Meta IP Ranges (Non-AI, routed to DIRECT)
IP-CIDR,69.171.224.0/19,DIRECT
IP-CIDR,108.168.176.192/26,DIRECT
IP-CIDR,108.177.8.0/21,DIRECT
RULE-SET,https://raw.githubusercontent.com/linchao10058/Surge/main/Rule/meta_non_ai_dynamic.list,DIRECT

# 5. Local Network Exclusion
IP-CIDR,192.168.0.0/16,DIRECT
IP-CIDR,10.0.0.0/8,DIRECT
IP-CIDR,172.16.0.0/12,DIRECT
IP-CIDR,100.64.0.0/10,DIRECT

# 6. Dynamic Update Mechanism
RULE-SET,https://raw.githubusercontent.com/linchao10058/Surge/main/Rule/meta_ai_dynamic.list,PROXY
RULE-SET,https://gitlab.com/linchao10058/Surge/raw/main/Rule/meta_ai_dynamic.list,PROXY
# Replace with actual Cloudflare Pages URL
RULE-SET,https://<actual-cloudflare-url>/linchao10058/Surge/meta_ai_dynamic.list,PROXY

# 7. Catch-all for non-Meta AI traffic
FINAL,DIRECT

[Script]
http-request ^https://.*\.meta\.(ai|com) script-path=https://raw.githubusercontent.com/linchao10058/Surge/main/Script/meta_ai_headers.js

[General]
loglevel=info
enhanced-mode=true
external-rule-update-interval=86400
force-timezone=America/New_York

[Host]
ai.meta.com = server:real-ip
meta.ai = server:real-ip