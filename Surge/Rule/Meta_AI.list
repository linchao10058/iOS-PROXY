# Surge Rule Set for Meta AI
# NAME: Meta AI
# AUTHOR: linchao10058
# REPO: https://raw.githubusercontent.com/linchao10058/Surge/main/Rule/meta_ai.list
# UPDATED: 2025-06-06 09:30 PDT
# TOTAL: 10 rules
# DESCRIPTION: Surge rules for routing Meta AI traffic (meta.ai, ai.meta.com) through a proxy. Excludes non-AI Meta services (e.g., Facebook, Instagram, WhatsApp). Supports dynamic updates via GitHub/GitLab. Compatible with Surge 5 and above.

[Rule]

# 1. Meta AI Core Domains (High Priority)
DOMAIN-SUFFIX,meta.ai,PROXY
DOMAIN-SUFFIX,ai.meta.com,PROXY
DOMAIN,imagine.meta.com,PROXY  # For image generation
DOMAIN-KEYWORD,meta-ai,PROXY  # Fallback for new Meta AI domains

# 2. Meta AI IP Ranges (Verified via ASN32934 and CDN)
IP-CIDR,157.240.241.0/24,PROXY
IP-CIDR,31.13.85.0/24,PROXY
IP-CIDR,185.89.216.0/22,PROXY
# Add CDN IP ranges after verification
# Example: IP-CIDR,104.18.0.0/20,PROXY  # Cloudflare (placeholder)

# 3. Local Network Exclusion
IP-CIDR,192.168.0.0/16,DIRECT
IP-CIDR,10.0.0.0/8,DIRECT
IP-CIDR,172.16.0.0/12,DIRECT

# 4. Dynamic Update Mechanism
RULE-SET,https://raw.githubusercontent.com/linchao10058/Surge/main/Rule/meta_ai_dynamic.list,PROXY
RULE-SET,https://gitlab.com/linchao10058/Surge/raw/main/Rule/meta_ai_dynamic.list,PROXY
# Replace with actual Cloudflare Pages URL
RULE-SET,https://<actual-cloudflare-url>/linchao10058/Surge/meta_ai_dynamic.list,PROXY

# 5. Catch-all for non-Meta AI traffic
FINAL,DIRECT

[Script]
# Optional: Spoof headers to bypass Meta AI restrictions
http-request ^https://.*\.meta\.(ai|com) script-path=https://raw.githubusercontent.com/linchao10058/Surge/main/Script/meta_ai_headers.js

[General]
# Enable debug logging and daily rule updates
loglevel=debug
enhanced-mode=true
external-rule-update-interval=86400
force-timezone=America/New_York